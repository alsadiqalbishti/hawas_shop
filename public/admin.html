<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªØ¬Ø±</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        /* Login Screen Styles */
        #loginScreen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-4);
        }

        .login-card {
            max-width: 420px;
            width: 100%;
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--space-5);
            box-shadow: var(--shadow-xl);
            position: relative;
            overflow: hidden;
        }

        .login-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
        }

        .login-header {
            text-align: center;
            margin-bottom: var(--space-5);
        }

        .login-icon {
            font-size: 4rem;
            margin-bottom: var(--space-3);
            display: block;
        }

        .login-title {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            color: var(--dark);
            margin-bottom: var(--space-2);
        }

        .login-subtitle {
            color: var(--text-light);
            font-size: var(--font-size-base);
        }

        /* Storage Usage Badge */
        .storage-badge {
            background: var(--light);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            font-size: var(--font-size-sm);
            display: flex;
            align-items: center;
            gap: var(--space-2);
            cursor: help;
            position: relative;
        }

        .storage-bar {
            width: 60px;
            height: 6px;
            background: var(--border);
            border-radius: var(--radius-full);
            overflow: hidden;
            position: relative;
        }

        .storage-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--warning), var(--danger));
            transition: width var(--transition-base);
            border-radius: var(--radius-full);
        }

        .storage-tooltip {
            position: absolute;
            bottom: 100%;
            right: 0;
            margin-bottom: var(--space-2);
            background: var(--dark);
            color: var(--white);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-md);
            font-size: var(--font-size-xs);
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity var(--transition-base);
            z-index: var(--z-tooltip);
        }

        .storage-badge:hover .storage-tooltip {
            opacity: 1;
        }
    </style>
</head>

<body>
    <!-- Login Screen -->
    <div id="loginScreen">
        <div class="login-card">
            <div class="login-header">
                <span class="login-icon">ğŸ”</span>
                <h1 class="login-title">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
                <p class="login-subtitle">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</p>
            </div>
            <div id="loginError" class="alert alert-error hidden"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="passwordInput" class="form-input" required
                        autocomplete="current-password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; padding: var(--space-3);">
                    ğŸ”“ Ø¯Ø®ÙˆÙ„
                </button>
            </form>
        </div>
    </div>

    <!-- Admin Panel with Sidebar -->
    <div id="adminPanel" class="hidden">
        <div class="admin-layout">
            <!-- Sidebar -->
            <aside class="admin-sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-logo">ğŸ“¦ Ù…ØªØ¬Ø±</div>
                </div>
                <nav class="sidebar-nav">
                    <a href="#" class="nav-item active" onclick="switchTab('products', this); return false;">
                        <span class="nav-item-icon">ğŸ›ï¸</span>
                        <span>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
                    </a>
                    <a href="#" class="nav-item" onclick="switchTab('orders', this); return false;">
                        <span class="nav-item-icon">ğŸ“‹</span>
                        <span>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span>
                    </a>
                    <a href="#" class="nav-item" onclick="switchTab('analytics', this); return false;">
                        <span class="nav-item-icon">ğŸ“Š</span>
                        <span>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</span>
                    </a>
                    <a href="#" class="nav-item" onclick="switchTab('delivery-men', this); return false;">
                        <span class="nav-item-icon">ğŸšš</span>
                        <span>Ù…Ù†Ø¯ÙˆØ¨Ùˆ Ø§Ù„ØªÙˆØµÙŠÙ„</span>
                    </a>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="admin-main">
                <!-- Header -->
                <header class="admin-header">
                    <div class="flex items-center gap-3">
                        <button class="sidebar-toggle" onclick="toggleSidebar()">â˜°</button>
                        <h1 class="header-title" id="pageTitle">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h1>
                    </div>
                    <div class="header-actions">
                        <div class="storage-badge" id="storageUsage">
                            <span id="storageText">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                            <div class="storage-bar">
                                <div class="storage-fill" id="storageFill" style="width: 0%;"></div>
                            </div>
                            <div class="storage-tooltip" id="storageTooltip"></div>
                        </div>
                        <button onclick="logout()" class="btn btn-danger btn-sm">
                            ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                        </button>
                    </div>
                </header>

                <!-- Content Area -->
                <div class="admin-content">
                    <!-- Products Tab -->
                    <div id="productsTab" class="tab-content active">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
                                <button onclick="openProductModal()" class="btn btn-primary">
                                    â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
                                </button>
                            </div>
                            <div class="card-body">
                                <!-- Product Search -->
                                <div class="filter-panel">
                                    <div class="form-group">
                                        <label class="form-label">ğŸ” Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</label>
                                        <input type="text" id="productSearch" class="form-input" 
                                            placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬ Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„ÙˆØµÙ..." 
                                            oninput="filterProducts()">
                                    </div>
                                </div>

                                <div id="productsContainer">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Orders Tab -->
                    <div id="ordersTab" class="tab-content">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
                                <div class="flex gap-2">
                                    <button onclick="exportOrders()" class="btn btn-info btn-sm">
                                        ğŸ“¥ ØªØµØ¯ÙŠØ±
                                    </button>
                                    <button onclick="loadOrders()" class="btn btn-success btn-sm">
                                        ğŸ”„ ØªØ­Ø¯ÙŠØ«
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <!-- Filter Panel -->
                                <div class="filter-panel">
                                    <div class="filter-row">
                                        <!-- Search -->
                                        <div class="filter-group">
                                            <label class="form-label">ğŸ” Ø¨Ø­Ø«</label>
                                            <input type="text" id="orderSearch" class="form-input" 
                                                placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ØŒ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ØŒ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ..." 
                                                oninput="filterOrders()">
                                        </div>
                                        
                                        <!-- Status Filter -->
                                        <div class="filter-group">
                                            <label class="form-label">Ø§Ù„Ø­Ø§Ù„Ø©</label>
                                            <select id="statusFilter" class="form-input" onchange="filterOrders()">
                                                <option value="">Ø§Ù„ÙƒÙ„</option>
                                                <option value="pending">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                                                <option value="assigned">Ù…ÙØ³Ù†Ø¯</option>
                                                <option value="preparing">Ù‚ÙŠØ¯ Ø§Ù„ØªØ­Ø¶ÙŠØ±</option>
                                                <option value="in_transit">Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                                                <option value="delivered">ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                                                <option value="completed">Ù…ÙƒØªÙ…Ù„</option>
                                                <option value="cancelled">Ù…Ù„ØºÙŠ</option>
                                                <option value="on_hold">Ù…Ø¹Ù„Ù‚</option>
                                            </select>
                                        </div>
                                        
                                        <!-- Date From -->
                                        <div class="filter-group">
                                            <label class="form-label">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                                            <input type="date" id="dateFrom" class="form-input" onchange="filterOrders()">
                                        </div>
                                        
                                        <!-- Date To -->
                                        <div class="filter-group">
                                            <label class="form-label">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                                            <input type="date" id="dateTo" class="form-input" onchange="filterOrders()">
                                        </div>
                                        
                                        <!-- Sort By -->
                                        <div class="filter-group">
                                            <label class="form-label">ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨</label>
                                            <select id="orderSortBy" class="form-input" onchange="applyFilters()">
                                                <option value="date-desc">Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø£Ø­Ø¯Ø«)</option>
                                                <option value="date-asc">Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø£Ù‚Ø¯Ù…)</option>
                                                <option value="status">Ø§Ù„Ø­Ø§Ù„Ø©</option>
                                                <option value="customer">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</option>
                                                <option value="orderNumber">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</option>
                                            </select>
                                        </div>
                                        
                                        <!-- Clear Filters -->
                                        <div class="filter-group">
                                            <label class="form-label">&nbsp;</label>
                                            <button onclick="clearFilters()" class="btn btn-secondary btn-sm" style="width: 100%;">
                                                ğŸ—‘ï¸ Ù…Ø³Ø­
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Bulk Actions -->
                                    <div class="flex justify-between items-center mt-4" style="padding-top: var(--space-3); border-top: 1px solid var(--border-light);">
                                        <div class="flex items-center gap-2">
                                            <input type="checkbox" id="selectAllOrders" onchange="toggleSelectAll()">
                                            <label for="selectAllOrders" style="margin: 0; cursor: pointer; font-weight: var(--font-weight-medium);">
                                                ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ (<span id="selectedCount">0</span>)
                                            </label>
                                        </div>
                                        <div class="flex gap-2">
                                            <button onclick="bulkUpdateStatus()" class="btn btn-primary btn-sm" id="bulkStatusBtn" disabled>
                                                ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©
                                            </button>
                                            <button onclick="bulkDelete()" class="btn btn-danger btn-sm" id="bulkDeleteBtn" disabled>
                                                ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯
                                            </button>
                                            <button onclick="bulkExport()" class="btn btn-info btn-sm" id="bulkExportBtn" disabled>
                                                ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø­Ø¯Ø¯
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div id="ordersContainer" class="mt-4">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Tab -->
                    <div id="analyticsTab" class="tab-content">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h2>
                                <div class="flex gap-2">
                                    <select id="analyticsPeriod" class="form-input" onchange="loadAnalytics()" style="width: auto;">
                                        <option value="all">Ø§Ù„ÙƒÙ„</option>
                                        <option value="today">Ø§Ù„ÙŠÙˆÙ…</option>
                                        <option value="week">Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…</option>
                                        <option value="month">Ø¢Ø®Ø± 30 ÙŠÙˆÙ…</option>
                                    </select>
                                    <button onclick="loadAnalytics()" class="btn btn-success btn-sm">
                                        ğŸ”„ ØªØ­Ø¯ÙŠØ«
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="analyticsContainer">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Delivery Men Tab -->
                    <div id="delivery-menTab" class="tab-content">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Ø¥Ø¯Ø§Ø±Ø© Ù…Ù†Ø¯ÙˆØ¨ÙŠ Ø§Ù„ØªÙˆØµÙŠÙ„</h2>
                                <button onclick="loadDeliveryMenList()" class="btn btn-success btn-sm">
                                    ğŸ”„ ØªØ­Ø¯ÙŠØ«
                                </button>
                            </div>
                            <div class="card-body">
                                <div id="deliveryMenContainer">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h2>
                <button class="modal-close" onclick="closeProductModal()">âœ•</button>
            </div>

            <form id="productForm">
                <input type="hidden" id="productId">

                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                    <input type="text" id="productName" class="form-input" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø³Ø¹Ø± (Ø¯ÙŠÙ†Ø§Ø± Ù„ÙŠØ¨ÙŠ)</label>
                    <input type="number" id="productPrice" class="form-input" required min="0" step="0.01" placeholder="0.00">
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <input type="number" id="productDiscountPrice" class="form-input" min="0" step="0.01"
                        placeholder="Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø®ØµÙ…">
                    <small style="color: var(--text-light); font-size: var(--font-size-sm); display: block; margin-top: var(--space-1);">
                        ğŸ’¡ Ø³ÙŠØ¸Ù‡Ø± Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ Ù…Ø´Ø·ÙˆØ¨Ø§Ù‹ Ù…Ø¹ Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…
                    </small>
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <input type="number" id="productStock" class="form-input" min="0" step="1"
                        placeholder="Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯">
                    <small style="color: var(--text-light); font-size: var(--font-size-sm); display: block; margin-top: var(--space-1);">
                        ğŸ“¦ Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ù„ØªØªØ¨Ø¹ ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯ØŒ Ø£Ùˆ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªÙˆÙØ±
                    </small>
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§Ù„ÙˆØµÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <textarea id="productDescription" class="form-textarea" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">ØµÙˆØ± Ø£Ùˆ ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ù†ØªØ¬</label>
                    <input type="file" id="productMedia" class="form-input" accept="image/*,video/*" multiple>
                    <small style="color: var(--text-light); font-size: var(--font-size-sm); display: block; margin-top: var(--space-1);">
                        ğŸ“¸ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø© ØµÙˆØ± Ø£Ùˆ ÙÙŠØ¯ÙŠÙˆ
                    </small>
                    <div id="currentMedia" class="mt-3"></div>
                </div>

                <div class="flex gap-2">
                    <button type="submit" class="btn btn-primary" style="flex: 1;">
                        ğŸ’¾ Ø­ÙØ¸
                    </button>
                    <button type="button" onclick="closeProductModal()" class="btn btn-danger">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="/admin.js"></script>
    <script>
        // Sidebar toggle for mobile
        function toggleSidebar() {
            const sidebar = document.querySelector('.admin-sidebar');
            sidebar.classList.toggle('open');
        }

        // Update page title when switching tabs
        const tabTitles = {
            'products': 'Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',
            'orders': 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª',
            'analytics': 'Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª',
            'delivery-men': 'Ù…Ù†Ø¯ÙˆØ¨Ùˆ Ø§Ù„ØªÙˆØµÙŠÙ„'
        };

        // Override switchTab to update title
        const originalSwitchTab = window.switchTab;
        window.switchTab = function(tabName, element) {
            if (originalSwitchTab) {
                originalSwitchTab(tabName, element);
            }
            const pageTitle = document.getElementById('pageTitle');
            if (pageTitle && tabTitles[tabName]) {
                pageTitle.textContent = tabTitles[tabName];
            }
            
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            if (element) {
                element.classList.add('active');
            }
        };
    </script>
</body>

</html>
